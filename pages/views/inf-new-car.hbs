<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>inf-new-car</title>
    <link rel="stylesheet" href="bootstrap-5.0.2-dist/css/bootstrap.min.css">
    <style>
        body {
            background: linear-gradient(90deg, #252222 0%, gray 80%);
        }

        .parent {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .son1 {

                {
                    {
                    !-- border: 2px solid gray;
                    --
                }
            }
        }

        .son2 {
            display: none;
            height: 250px;
        }

        .lbl1 {
            font-size: large;
            font-style: italic;
            color: gray;
        }

        .lbl2 {
            font-size: large;
            font-style: italic;
            color: rgb(21, 240, 13);
            font-weight: bold;
        }

        table {
            width: 85%;
            text-align: center;
            margin-top: 30px;
            margin-left: 60px;
        }

        table,
        td,
        th {
            border: 1px solid;
            color: white;
            font-size: 17px;
            font-style: italic;

        }

        tbody tr:nth-child(even) {
            background-color: rgb(141, 185, 196);
            color: white;
        }

        tbody tr:nth-child(odd) {
            background-color: rgb(170, 167, 167);
            color: white;

        }
        .bnt {
            width: 500px;
            height: 50px;
            margin-top: 16px;
            margin-left: 100px;
            border-radius: 20px;
            background-color: rgb(146, 143, 143);
            color: white;
            font-size: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 700;
            font-style: italic;
        }
    </style>

</head>

<body>
    <div class="parent">
        <div class="son1">
            <button class="bnt">get information of all Shown Cars</button>
            <table>
                <thead>
                    <tr>
                        <th>id</th>
                        <th>imageName</th>
                        <th>carName</th>
                        <th>carDiscription</th>
                        <th>price</th>
                        <th>delete</th>
                        <th>Patch</th>

                    </tr>
                </thead>
                <tbody class="bo">


                </tbody>
            </table>
            <input class="inp" type="text" style="visibility: hidden;">
        </div>


        <div class="son2">
            <section class="sec " style="height: 300px;">
                <div class="mask d-flex align-items-center h-100 gradient-custom-3">
                    <div class="container h-100">
                        <div class="row d-flex justify-content-center align-items-center h-100">
                            <div class="col-12 col-md-9 col-lg-7 col-xl-6">
                                <div class="card" style="border-radius: 15px;">
                                    <div class="card-body p-5">
                                        <h2 class="text-uppercase text-center mb-5">Update Here</h2>

                                        <form>
                                            <div class="form-outline mb-4" style="visibility: hidden;">
                                                <input type="text" id="form3Example1cg"
                                                    class="form-control form-control-lg inp0" />
                                                <label class="form-label" for="form3Example1cg">ID</label>
                                            </div>

                                            <div class="form-outline mb-4">
                                                <input type="text" id="form3Example1cg"
                                                    class="form-control form-control-lg inp1" />
                                                <label class="form-label" for="form3Example1cg">imagename</label>
                                            </div>

                                            <div class="form-outline mb-4">
                                                <input type="email" id="form3Example3cg"
                                                    class="form-control form-control-lg inp2" />
                                                <label class="form-label" for="form3Example3cg">carname</label>
                                            </div>

                                            <div class="form-outline mb-4">
                                                <input type="email" id="form3Example3cg"
                                                    class="form-control form-control-lg inp3" />
                                                <label class="form-label" for="form3Example3cg">description</label>
                                            </div>

                                            <div class="form-outline mb-4">
                                                <input type="text" id="form3Example4cg"
                                                    class="form-control form-control-lg inp4" />
                                                <label class="form-label" for="form3Example4cg">price</label>
                                            </div>
                                            <label class="msg"></label>
                                            <div class="d-flex justify-content-center">
                                                <button type="button"
                                                    class="btn22 btn-success btn-block btn-lg gradient-custom-4 text-body">Updata</button>
                                            </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>


    <script>
        const button22 = document.querySelector(".bnt")
        const input = document.querySelector(".inp")
        const labelid = document.querySelector(".classId")
        const submitdelete = document.querySelector(".butt")
        const son2 = document.querySelector(".son2")
        const buttonUpdata = document.querySelector(".btn22")
        const id = document.querySelector(".inp0")
        const imagename = document.querySelector(".inp1")
        const carname = document.querySelector(".inp2")
        const carDiscription = document.querySelector(".inp3")
        const price = document.querySelector(".inp4")
        const msg = document.querySelector(".msg")
        button22.addEventListener("click", async function () {
            await fetch('http://localhost:3000/task2Details')

                .then((tasks) => tasks.json())
                .then((tasks) => {

                    const tbody = document.querySelector(".bo")
                    tasks.forEach((task) => {
                        const row = document.createElement('tr');

                        const idCell = document.createElement('td');
                        idCell.textContent = task._id;
                        row.appendChild(idCell);

                        const namecarCell = document.createElement('td');
                        namecarCell.textContent = task.imageName;
                        row.appendChild(namecarCell);

                        const carNameCell = document.createElement('td');
                        carNameCell.textContent = task.carName;
                        row.appendChild(carNameCell);

                        const carDiscriptionCell = document.createElement('td');
                        carDiscriptionCell.textContent = task.carDiscription;
                        row.appendChild(carDiscriptionCell);

                        const priceCell = document.createElement('td');
                        priceCell.textContent = task.price;
                        row.appendChild(priceCell);

                        const deleteCell = document.createElement('td');
                        const button2 = document.createElement("button")
                        button2.innerHTML = task._id
                        deleteCell.appendChild(button2)
                        row.appendChild(deleteCell)

                        const patchCell = document.createElement('td');
                        const button3 = document.createElement("button")
                        button3.innerHTML = task._id
                        patchCell.appendChild(button3)
                        row.appendChild(patchCell)

                        tbody.appendChild(row);


                        button2.addEventListener("click", (e) => {
                            input.value = button2.textContent
                            const _id = button2.textContent
                            console.log(_id)
                            fetch("http://localhost:3000/inf-new-car", {
                                method: 'DELETE',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ _id: _id })
                            })

                                .then((data) => {
                                    alert("You have deleted task")
                                    console.log(data)

                                }).catch((e) => {
                                    console.log(e)
                                })

                        })

                        button3.addEventListener("click", async (req, res) => {
                            input.value = button3.textContent
                            const _id = button3.textContent
                            console.log(_id)

                            await fetch("http://localhost:3000/task2Details")
                                .then((task) => task.json())
                                .then((data) => {
                                    function getData() {
                                        return data.filter((e) => {
                                            return e._id == _id; // fetch array object if it matches the value
                                        })
                                    }
                                    var result = getData();
                                    console.log(result)
                                    let idtask = result.map(a => a._id)
                                    id.value = idtask

                                    let imageName = result.map(a => a.imageName)
                                    imagename.value = imageName

                                    let carnamee = result.map(a => a.carName)
                                    carname.value = carnamee

                                    let cardiscription = result.map(a => a.carDiscription)
                                    carDiscription.value = cardiscription
                                    let Price = result.map(a => a.price)
                                    price.value = Price
                                    son2.style.display = "block"

                                    function submitform(e) {

                                        const _id = document.querySelector(".inp0").value
                                        const imageName = document.querySelector(".inp1").value
                                        const carName = document.querySelector(".inp2").value
                                        const carDiscription = document.querySelector(".inp3").value
                                        const price = document.querySelector(".inp4").value


                                        fetch("http://localhost:3000/inf-new-car", {
                                            method: 'PATCH',
                                            headers: {
                                                'Content-Type': 'application/json'
                                            },
                                            body: JSON.stringify({ _id: _id, imageName: imageName, carName: carName, carDiscription: carDiscription, price: price })
                                        })
                                            .then(response => response.json())
                                            .then((data) => {
                                                console.log(data)
                                                msg.innerHTML = "Successufly Updata"
                                                location.reload()
                                            }).catch((e) => {
                                                console.log(e)
                                            })



                                    }
                                    buttonUpdata.addEventListener('click', submitform)
                                })

                        })



                    })
                })
        })


    </script>
</body>

</html>